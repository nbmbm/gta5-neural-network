# Нейросеть для игры в GTA 5

Этот проект позволяет создать и обучить нейронную сеть, которая сможет играть в GTA 5, анализируя изображения с экрана и управляя клавиатурой и мышью.

## Необходимые компоненты

- Python 3.8 или новее
- PyTorch
- CUDA (для ускорения на GPU)
- GTA 5

## Установка

1. Клонируйте репозиторий:
```
git clone https://github.com/username/gta5-ai.git
cd gta5-ai
```

2. Установите необходимые библиотеки:
```
pip install -r requirements.txt
```

3. Убедитесь, что CUDA настроена правильно (для работы на GPU):
```
python -c "import torch; print(torch.cuda.is_available())"
```
Должно вывести `True`.

## Пошаговая инструкция

### Шаг 1: Сбор данных

Сначала нужно собрать данные для обучения. Для этого запустите скрипт сбора данных, который будет записывать ваш игровой процесс:

```
python data_collection.py
```

При запуске следуйте инструкциям на экране:
1. Запустите GTA 5
2. Переключитесь на игру
3. Запись начнется автоматически
4. Играйте как обычно (программа будет записывать ваши действия и изображения с экрана)
5. Нажмите F9 для приостановки/возобновления записи
6. Нажмите F10 для завершения записи

Данные будут сохранены в папке `data/gameplay_data.h5`.

### Шаг 2: Обучение модели

После сбора данных можно приступить к обучению модели:

```
python train.py --mode supervised --data data/gameplay_data.h5 --epochs 30
```

Параметры:
- `--mode`: режим обучения (`supervised` - имитационное обучение)
- `--data`: путь к собранным данным
- `--epochs`: количество эпох обучения
- `--model_type`: тип модели (`simple` или `lstm`)
- `--batch_size`: размер партии для обучения
- `--learning_rate`: скорость обучения

Обучение может занять несколько часов в зависимости от объема данных и мощности компьютера.
Модель будет сохраняться каждые 5 эпох в папке `models/`.

### Шаг 3: Запуск модели для игры

После обучения можно запустить модель, чтобы она начала играть в GTA 5:

```
python play.py --model models/final_model.pth --visualize
```

Параметры:
- `--model`: путь к обученной модели
- `--model_type`: тип модели (`simple` или `lstm`)
- `--visualize`: показывать визуализацию действий модели

После запуска:
1. Запустите GTA 5
2. Переключитесь на игру
3. Нажмите F9, чтобы модель начала играть
4. Нажмите F9 еще раз для приостановки
5. Нажмите F10 для выхода

## Структура проекта

- `model.py` - определение архитектуры нейронной сети
- `utils.py` - вспомогательные функции
- `data_collection.py` - скрипт для сбора данных
- `train.py` - скрипт для обучения модели
- `play.py` - скрипт для запуска обученной модели
- `models/` - папка для сохранения обученных моделей
- `data/` - папка для сохранения данных

## Особенности и рекомендации

### Оптимизация для аппаратного обеспечения

Проект оптимизирован для работы на компьютере со следующими характеристиками:
- GTX 1650
- 6GB RAM
- I7-8020X
- 500 ГБ свободного места на диске

Для более слабого оборудования:
- Уменьшите разрешение изображений (измените `FRAME_WIDTH` и `FRAME_HEIGHT` в `utils.py`)
- Уменьшите размер партии (`--batch_size`)
- Используйте более простую модель (`--model_type simple`)

Для более мощного оборудования:
- Увеличьте разрешение изображений
- Увеличьте размер партии
- Используйте более сложную модель (`--model_type lstm`)

### Рекомендации по сбору данных

Для лучших результатов:
- Соберите не менее 1 часа игрового процесса
- Включите разнообразные ситуации (вождение, стрельба, ходьба и т.д.)
- Старайтесь играть стабильно и предсказуемо
- Делайте несколько сессий сбора данных в разных условиях игры

### Советы по обучению

- Начните с малого количества эпох (10-20) и проверьте результаты
- Если модель плохо учится, увеличьте скорость обучения или соберите больше данных
- Сохраняйте промежуточные модели и тестируйте их, чтобы найти лучшую
- Используйте визуализацию (`--visualize`) для анализа работы модели

## Поиск и устранение неисправностей

### Проблемы с установкой PyTorch и CUDA

Если возникают проблемы с CUDA, попробуйте:
1. Обновите драйверы GPU
2. Установите PyTorch с поддержкой CUDA, используя команду с официального сайта
3. Проверьте совместимость версий PyTorch и CUDA

### Ошибки захвата экрана

Если возникают проблемы с захватом экрана:
1. Убедитесь, что GTA 5 запущена в оконном режиме
2. Настройте параметры монитора в `utils.py`, функция `capture_screen()`
3. Попробуйте другие библиотеки захвата экрана (например, `pyscreenshot` вместо `mss`)

### Модель не обучается

Если модель не обучается или обучается плохо:
1. Соберите больше данных
2. Проверьте качество данных (визуализируйте несколько изображений и соответствующие им действия)
3. Измените гиперпараметры обучения (скорость обучения, размер партии)
4. Попробуйте другую архитектуру модели

## Дальнейшее развитие

Возможные улучшения проекта:
- Добавление обучения с подкреплением (RL)
- Интеграция с API GTA 5 для более точного управления
- Добавление детекции объектов для лучшего понимания игровой среды
- Реализация многозадачного обучения (вождение, стрельба, навигация и т.д.)

## Лицензия

MIT License

## Контакты

При возникновении вопросов или предложений, пожалуйста, создайте Issue в репозитории GitHub. 